(this["webpackJsonpyoudash-mobile-app"]=this["webpackJsonpyoudash-mobile-app"]||[]).push([[13],{319:function(e,t,n){"use strict";n.d(t,"b",(function(){return o}));var i=n(11),r=n(8),c=n(1),a=n(63),o=function(e,t){var n=0,i=0,c=t.map((function(t){return t&&t.subSubItems&&t.subSubItems.length?Object(r.a)(Object(r.a)({},t),{},{subSubItems:t.subSubItems.map((function(t){if(t.versionPriceAdjustment&&t.versionPriceAdjustment.length>0){var r=t.versionPriceAdjustment.filter((function(t){return t.versionId===e}));r&&r.length>0&&t.priceAdjustment&&r[0].cost&&(t.isSelected&&(n+=t.priceAdjustment,i+=r[0].cost),t.priceAdjustment=r[0].cost)}else!t.versionPriceAdjustment&&t.priceAdjustment&&t.isSelected&&(n+=t.priceAdjustment,i+=t.priceAdjustment);return t}))}):t}));return{oldPriceDifference:n,newPriceDifference:i,items:c}};t.a=function(e){var t=Object(c.useState)(null),n=Object(i.a)(t,2),s=n[0],u=n[1];return Object(c.useEffect)((function(){e&&"undefined"!==typeof e&&u(Object(a.e)(e,(function(t){e.quantity||(t.quantity=1)})))}),[e]),[s,function(e,t,n,i,c,o,l){u(Object(a.e)(s,(function(a){if(l&&(a.itemOptions[t][e].subSubItems=a.itemOptions[t][e].subSubItems.map((function(e){if(e.priceAdjustment&&e.isSelected){var t=a.price-=e.priceAdjustment;a.price=t>=0?t:0}return Object(r.a)(Object(r.a)({},e),{},{isSelected:!1})}))),a.itemOptions[t][e].subSubItems[n][i]=o,c&&o)a.price+=c;else if(c&&!o){var s=a.price-=c;a.price=s>=0?s:0}var u=a.itemOptions[t][e],m=u.maxSubSubCount;u.minSubSubCount;if(m&&!l){var f=a.itemOptions[t][e].subSubItems.filter((function(e){return e.isSelected})).length;a.itemOptions[t][e].subSubItems=f===m?a.itemOptions[t][e].subSubItems.map((function(e){return e.isSelected?e:Object(r.a)(Object(r.a)({},e),{},{isDisabled:!0})})):a.itemOptions[t][e].subSubItems.map((function(e){return e.isDisabled?Object(r.a)(Object(r.a)({},e),{},{isDisabled:!1}):e}))}})))},function(){u(Object(a.e)(s,(function(e){e.quantity=e.quantity+1})))},function(){u(Object(a.e)(s,(function(e){e.quantity=e.quantity>1?e.quantity-1:1})))},function(e){u(Object(a.e)(s,(function(t){t.comments=e.target.value})))},function(e){u(Object(a.e)(s,(function(t){var n=t.itemVersions.filter((function(t){return t.itemVersion===e})),i=t.itemVersion,r=t.itemVersions.filter((function(e){return e.itemVersion===("object"===typeof i?i.versionId:i)}));if(r&&r.length>0&&n&&n.length>0){var c,a,s,u=r[0].price,l=n[0].price;t.price-=u,t.price+=l,t.itemVersion=n[0].itemVersion;var m=null===t||void 0===t||null===(c=t.itemOptions)||void 0===c?void 0:c.subOptions,f=null===t||void 0===t||null===(a=t.itemOptions)||void 0===a?void 0:a.subItems,d=null===t||void 0===t||null===(s=t.itemOptions)||void 0===s?void 0:s.subItemsLeft;if(m&&m.length){var b=o(e,m);t.itemOptions.subOptions=b.items,t.price-=b.oldPriceDifference,t.price+=b.newPriceDifference}if(f&&f.length){var p=o(e,f);t.itemOptions.subItems=p.items,t.price-=p.oldPriceDifference,t.price+=p.newPriceDifference}if(d&&d.length){var O=o(e,d);t.itemOptions.subItemsLeft=O.items,t.price-=O.oldPriceDifference,t.price+=O.newPriceDifference}}})))}]}},362:function(e,t,n){},364:function(e,t,n){},413:function(e,t,n){"use strict";n.r(t);var i=n(8),r=n(46),c=n(11),a=n(1),o=n.n(a),s=n(27),u=n(301),l=n(411),m=n(71),f=n(339),d=(n(362),n(363)),b=n(52),p=n(31),O=n.n(p),v=n(55),j=n(10);var h=function(e){e.id,e.title,e.price;var t=e.items,n=e.status,i=(e.date,e.orderUUID),r=e.orderNumber,a=e.dateTimeOrderPlacedOn,l=e.onReOrder,p=(function(e){var t={"picked-up":{title:"Picked Up",icon:o.a.createElement(f.a,null)},canceled:{title:"Canceled",icon:o.a.createElement(f.e,null)},awaiting:{title:"Awaiting",icon:o.a.createElement(f.c,null)}}}(n),{title:"YouDash French Bakery",text:"YouDash French Bakery - the best bakery in the world!",url:"https://youdash.co/french-bakery"}),h=function(){var e=Object(j.c)((function(e){return e.business.data}));return[function(){var t=Object(v.a)(O.a.mark((function t(n){var i,r,c,a;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=n.title,r=n.text,c=n.url,void 0===navigator.share||!e){t.next=11;break}return a=e.ogTags,t.prev=3,t.next=6,navigator.share({title:i||a.title,text:r||a.description,url:c||window.location.href});case 6:t.next=11;break;case 8:t.prev=8,t.t0=t.catch(3),console.log("Share failed.");case 11:case"end":return t.stop()}}),t,null,[[3,8]])})));return function(e){return t.apply(this,arguments)}}()]}(),y=Object(c.a)(h,1)[0],g=Object(s.g)(),S=Object(s.h)().search,E=Object(s.i)().businessUrlKey;return o.a.createElement(b.a,{className:"order-history-card"},o.a.createElement("div",{className:"flex orders"},o.a.createElement("ul",null,(t||[]).map((function(e,t){var n=e.itemName,r=e.quantity;return o.a.createElement("li",{key:"product-list-item".concat(i+t)},n," x",r)}))),o.a.createElement(u.a,{icon:o.a.createElement(d.b,null),onClick:function(){return g.push("/".concat(E,"/order-status/").concat(i).concat(S))},type:"primary"},"Status")),o.a.createElement("div",{className:"share-order flex"},o.a.createElement(u.a,{icon:o.a.createElement(m.j,null),onClick:function(){return y(p)}},"Share"),o.a.createElement(u.a,{icon:o.a.createElement(d.a,null),onClick:function(){return l(t)},type:"primary"},"Add all to cart")),o.a.createElement("div",{className:"flex order-history-card-footer font-size-sm"},o.a.createElement("span",null,a),r&&o.a.createElement("span",null,"#",r)))},y=(n(364),function(e){var t=e.orders,n=e.onReOrder,i=e.onReloadHistory,r=e.loading,s=Object(a.useState)(""),d=Object(c.a)(s,2),b=d[0],p=d[1];return o.a.createElement("div",{className:"p-default order-history"},o.a.createElement("h3",{className:"font-size-lg flex"},o.a.createElement("span",null,"Search order"),o.a.createElement(u.a,{type:"primary",icon:o.a.createElement(f.b,null),loading:r,onClick:i})),o.a.createElement(l.a,{value:b,onChange:function(e){return p(e.target.value)},size:"large",placeholder:"Search order by name",prefix:o.a.createElement(m.i,null),className:"card bg-secondary"}),(b.length>1&&t?t.filter((function(e){return e.items.filter((function(e){return-1!==e.itemName.toLowerCase().indexOf(b.toLowerCase())})).length})):t||[]).map((function(e,t){return o.a.createElement(h,Object.assign({},e,{onReOrder:n,key:"orderHistory".concat(t)}))})))}),g=n(54),S=n(63),E=n(319),I=n(148);t.default=function(e){var t=e.businessData,n=e.loyaltyAndOrderHistory,u=Object(s.h)().search,l=Object(s.g)(),m=Object(j.b)(),f=Object(s.i)().businessUrlKey,d=Object(a.useState)([]),b=Object(c.a)(d,2),p=b[0],O=b[1],v=Object(I.a)(),h=Object(c.a)(v,4),w=(h[0],h[1],h[2]),D=h[3];Object(a.useEffect)((function(){n&&n.orderHistory&&O(n.orderHistory)}),[n]);return o.a.createElement(y,{orders:p,onReOrder:function(e){e&&e.length>0&&(e.map((function(e){var n=e.itemOptionsString,c=e.itemVersion,a=e.item,o=(Object(r.a)(e,["itemOptionsString","itemVersion","item"]),Object(S.e)(t.itemsById[a.uuid],(function(e){})));if(o){var s,u,l,f=null;try{f=JSON.parse(n)}catch(j){f=o.itemOptions}var d=c&&"object"===typeof c?c.price:o.price,b=c&&"object"===typeof c?c.itemVersion:o.itemVersion,p=null===(s=f)||void 0===s?void 0:s.subOptions,O=null===(u=f)||void 0===u?void 0:u.subItems,v=null===(l=f)||void 0===l?void 0:l.subItemsLeft;if(p&&p.length)d+=Object(E.b)(b,p).newPriceDifference;if(O&&O.length)d+=Object(E.b)(b,O).newPriceDifference;if(v&&v.length)d+=Object(E.b)(b,v).newPriceDifference;m(Object(g.a)(Object(i.a)(Object(i.a)({},o),{},{quantity:a.quantity,itemVersion:a.itemVersion,itemOptions:f,price:d})))}return a})),l.push("/".concat(f,"/order-details").concat(u)))},loading:D,onReloadHistory:w})}}}]);
//# sourceMappingURL=13.bf7310be.chunk.js.map